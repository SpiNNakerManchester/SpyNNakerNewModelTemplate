\documentclass[12pt]{article}
\usepackage{graphicx}
%\title{IF\_curr\_comb\_exp: combined exponential synaptic response}
\title{Synapse Modelling on SpiNNaker}
\author{Oliver Rhodes}
\date{\today}


\begin{document}
\maketitle

\begin{abstract}
This article introduces the various types of synapse model available within the
current SpiNNaker API, and then discusses several extensions and new models to
cover methods from the literature on computational neuroscience. The underlying
models, together with SpiNNaker-specific implementation details are discussed,
followed by a comparison of the effects on wider neural networks.
\end{abstract}

\section{Introduction}
In neuron-based modelling, neural networks are defined from populations of
neurons, and then connected via synapses, replicating the physiological layout
of the brain. The neurons take input from others in the network when connected
neurons spike, leading to a transfer of current from synaptic binding. The
neuron behaviour -- such as firing dynamics and threshold -- are typically
defined by a neuron model: with common implementations including the leaky
integrate and fire (LIF) ***cite***, or Izhikevich
\cite{SimpleModelofSpikingNeurons} neurons. These
essentially govern how and when a neuron will fire, and once fired, the reset
state. How these neurons are excited and inhibited by others in the network is
determined by the firing of connected neurons. Upon firing a presynaptic neuron
will cause binding of the synaptic transmitters, which in turn open ion
channels, allowing current to flow. This flow of current is fed into the
post-synaptic neuron, causing a resulting effect in the neuron model.

The time-dependent behaviour of this synaptic response (i.e. what current
is fed into the post-synaptic neuron) is the subject of the remainder of this
work: in the following section various synaptic model are introducted, before
results are presented for comparion and dicussion.

\section{Synapse Modelling}
Due to the high connectivity between neurons in the brain, sysnapses form a
major part of neural netowrks. Their number can exceed the number of neurons by
several orders of magnitude ***cite***, meaning efficient implementation is a
critical factor in overall network performance ***cite***. Further consideration
must also be made of the underlying computational framework used to build and
run the neuralnetwork. In this work the SpiNNaker platform is used, which
presents various restrictions ***cite*** such as: limited memory (for both
instruction ITCM, and state variables DTCM), and 32-bit fixed-point arithmetic
without division support. This section covers the introduction of four models,
representing increasing complexity and computational cost. For each model, the
underlying mathematical response is introduced, followed by details of the
SpiNNaker-specific implementation.

\subsection{Instantaneous Rise and Exponential Decay}
\subsubsection*{Synaptic Response}
The response of ion channels opening and closing is typcially characterised by
fast opening, followed by slower closing ***cite***. As the charge flowing
through the synapse is proportional to this opening and closing, a simple and
efficient response can be defined using an instanaeous rise to peak flow (upon
the presynaptic neuron receiving a spike), followed by an exponential decay
back to a closed state. Modelling using exponential function, the conductance
as a function of time $g(t)$, is defined mathematically as:
\begin{equation}
g(t) = \bar{g}_{syn} e^{-t/\tau}
\end{equation}
where $t$ is time, and $\tau$ is a decay constant governing rate of closing of a
synapse.

\subsubsection*{SpiNNaker Implementation}
Because of the lack of division operator on SpiNNaker, the quotient $t/\tau$ is
precomputed, and a multiplier used to decay the conductance by a consistent
fraction over each timestep. For example, if $\tau = 5$, and the simulation
timestep is $\delta t = 0.1 \mathrm{ms}$, this factor is given by $e^{t/\tau} =
e^{0.1/5} = 0.980$
The code to evaluate synapse shaping therefore requires parameters for: the
decay scalar, the initial decay scalar, and the current value of the evaluated
exponential (for use by the postsynaptic neuron). To enable fixed-point
computation of output values, each parameter is stored via a custom SpiNNaker
datatype occupying

\subsection{Alpha Response}
The alpha response represents a more physiologically-accurate synaptic response,
whereby the synaptic ion channels open over a finite time interval. The
response is typically comprised of a fast opening time, and hence initial rise
in conductance, followed by a relatively slow decay back to the closed state (see
Fig.~ ***)

\subsubsection*{Synaptic Response}
The characteristic `alpha' response is defined by two coupled differential
equations.  Upon combination, and setting equal time constants, a response
similar to combining two exponential responses is achieved. The response of
$g_{syn}$, together with the two coupled differential equations, can be defined
as:
\begin{eqnarray}
g_{syn}(t) & = & \bar{g}_{syn}fg(t) \nonumber \\
\frac{dg}{dt} & = & \frac{1}{\tau_{decay}} (-g + h) \nonumber \\
\frac{dh}{dt} & = & \frac{1}{\tau_{rise}}(-h) \nonumber
\label{eqn:alpha_coupled_diff_eqns}
\end{eqnarray}

Setting $\tau_{rise}=\tau_{decay} = \tau$ and solving for $h(t)$ via separation
of variables:
\begin{eqnarray}
\int \frac{1}{h} dh & = & \int -\frac{1}{\tau}dt \nonumber \\
\ln{h}&=&-\frac{t}{\tau} + C \nonumber \\
h(t) & = & e^{-{t/\tau}+C} = ke^{-t / \tau} \nonumber
\label{eqn:solve_for_h}
\end{eqnarray}
Rearranging to the form $\frac{dy}{dt} +Py = Qt$, substituting  for $h(t)$, and
solving for $g(t)$ by integration via the particular integral (and the reverse
product rule):
\begin{eqnarray}
\frac{dg}{dt} + \frac{g}{\tau}&=&\frac{k}{\tau}e^{-t/\tau} \nonumber\\
\mathrm{P.I.}&=& e^{\int P dt} = e^{t/ \tau} \nonumber \\
e^{t/\tau}\frac{dg}{dt} + e^{t/\tau}\frac{g}{\tau}
&=& \frac{k}{\tau}e^{-t/\tau}e^{t/\tau} \nonumber \\
\frac{d}{dt} g e^{\frac{t}{\tau}}&=&\frac{k}{\tau}e^{-\frac{t}{\tau}
+\frac{t}{\tau}} \nonumber \\
g e^{\frac{t}{\tau}} &=& \int \frac{k}{\tau}e^0 dt  =  \frac{kt}{\tau} \nonumber \\
g(t)&=&\frac{kt}{\tau}e^{-t/\tau}
\end{eqnarray}


\subsubsection*{SpiNNaker Implementation}

\subsection{Combined Exponentials}
\subsubsection*{Synaptic Response}
Whilst the alpha synapse offers flexibility to define a range of fast rising and
slowly decaying conductance profiles, the two regimes are inherentyl coupled,
and hence it's difficult to effect the individual rise and decay components of
the overall response. To overcome this limitation, and to faciliate
an instantaneous rise and two-phase decay respone, a conductance profile based
on the combination of two exponentials is defined below.

The response is built from the summation of two exponential decay functions,
similar to that defined for the instantaneous rise and decay model. However, in
this general implementation, coefficients $A$ and $B$ are added to enable
scaling of the individual components. The conductance profile can therefore be
defined as:
\begin{equation}
g_{syn}(t)=\bar{g}_{syn}f\Big(Ae^{-t / \tau_a} + Be^{-t / \tau_b}\Big)
\label{eqn:combined_general_form}
\end{equation}
where $\tau_a$ and $\tau_b$ define two individual time constants. The response
in Eqn.~\ref{eqn:combined_general_form} faciliates two interesting behaviours
when the signs of constants $A$ and $B$ are either equal or opposite.

\paragraph{Difference of two exponentials: $A>0, B<0$ \newline}
\noindent Setting the coefficients $A = -B = 1$ and $\tau_a > \tau_b$ --
noting that a larger $\tau$~-~value yields a slower decay function -- results in
the difference between the two exponential functions shown in Fig.~\ref{fig:difference_exp_example}.
\begin{figure}[!h]
\begin{centering}
\includegraphics[width=0.5\textwidth]{combined_general_difference.ps}
\caption{Example conductance response for combined exponential model}
\label{fig:difference_exp_example}
\end{centering}
\end{figure}
Upon spiking $t = 0$, resulting in a net conductance of zero. The initial rise
in conductance is governed by the value of $\tau_a$, with the post-peak response
dominated by $\tau_b$. Equation.~\ref{eqn:combined_general_form} can
therefore be rewritten with $\tau_a = \tau_{decay}$ and $\tau_b = \tau_{rise}$
as:
\begin{equation}
g_{syn}(t)=\bar{g}_{syn}f\Big(e^{-t / \tau_{decay}} - e^{-t /
\tau_{rise}}\Big)
\label{eqn:}
\end{equation}
where f is a scalar ensuring $g_{syn} = \bar{g}_{syn}$ at the response peak. It
follows from stationary point theory that for the case $A = -B = 1$:
\begin{eqnarray}
t_{peak}&=&\frac{\tau_{rise}\tau_{decay}}{\tau_{decay}
- \tau_{rise}}\ln\frac{\tau_{decay}}{\tau_{rise}} \nonumber
\\
f&=&\Big( e^{-t_{peak} / \tau_{decay}} - e^{-t_{peak} / \tau_{rise}}\Big)^{-1}
\nonumber
\label{eqn:combined_exponential_diff_response}
\end{eqnarray}
This synapse model therefore allows tuning of the initial rise and post-peak
decay to match experimentally observed synapse behaviour.

\paragraph{Cumulation of two exponentials: $A>0, B>0$ \\}
\noindent Taking the second case where both coefficients in
Eqn.~\ref{eqn:combined_general_form} are of the same sign, the response in
Fig.~\ref{fig:combined_exp_example} can be achieved.
 \begin{figure}[!h]
\begin{centering}
\includegraphics[width=0.5\textwidth]{combined_general_cumulation.ps}
\caption{Example conductance response from summation of two exponential
components}
\label{fig:combined_exp_example}
\end{centering}
\end{figure}
This gives rise to an instantaneous rise, followed by a decay
response comprised of short and long-term components. Setting $\tau_a > \tau_b$
results in an initial short-term decay dominated by $\tau_b$ and a long-term
decay dominated by $\tau_a$. Rewriting Eqn~\ref{eqn:combined_general_form} as:
\begin{equation}
g_{syn}(t)=\bar{g}_{syn}f\Big(Ae^{-t / \tau_{long}} + Be^{-t /
\tau_{short}}\Big)
\label{eqn:combined_exponential_cumulation_response}
\end{equation}

\subsubsection*{SpiNNaker Implementation}
A generic combined exponential synapse is implemented allowing both profiles
described above to be defined. This response therefore requires


\subsection{Biphasic}
\subsubsection*{Synaptic Response}
As seen in the previous section, combining exponential functions allows
tailoring of the synaptic response. It is clear that increasing the number of
exponential terms will further increase this flexibilty, and also allows
representation of more complex functions. One such example is the biphasic
response shown in Fig.~\ref{fig:biphasic_response}
\begin{figure}
\begin{centering}
\label{fig:biphasic_response}
\end{centering}
\end{figure}


 \subsubsection*{SpiNNaker Implementation}

\section{Results}

\section{Discussion}
\section{Appendix}
\appendix
\section{Alpha Response Derivation}
\begin{eqnarray}
g_{syn}(t) & = & \bar{g}_{syn}fg(t) \nonumber \\
\frac{dg}{dt} & = & \frac{1}{\tau_{decay}} (-g + h) \nonumber \\
\frac{dh}{dt} & = & \frac{1}{\tau_{rise}}(-h) \nonumber
\end{eqnarray}

Setting $\tau_{rise}=\tau_{decay} = \tau$ and solving for $h(t)$ via separation
of variables:
\begin{eqnarray}
\int \frac{1}{h} dh & = & \int -\frac{1}{\tau}dt \nonumber \\
\ln{h}&=&-\frac{t}{\tau} + C \nonumber \\
h(t) & = & e^{-{t/\tau}+C} = ke^{-t / \tau} \nonumber
\end{eqnarray}
Rearranging to the form $\frac{dy}{dt} +Py = Qt$, substituting  for $h(t)$, and
solving for $g(t)$ by integration via the particular integral (and the reverse
product rule):
\begin{eqnarray}
\frac{dg}{dt} + \frac{g}{\tau}&=&\frac{k}{\tau}e^{-t/\tau} \nonumber\\
\mathrm{P.I.}&=& e^{\int P dt} = e^{t/ \tau} \nonumber \\
e^{t/\tau}\frac{dg}{dt} + e^{t/\tau}\frac{g}{\tau}
&=& \frac{k}{\tau}e^{-t/\tau}e^{t/\tau} \nonumber \\
\frac{d}{dt} g e^{\frac{t}{\tau}}&=&\frac{k}{\tau}e^{-\frac{t}{\tau}
+\frac{t}{\tau}} \nonumber \\
g e^{\frac{t}{\tau}} &=& \int \frac{k}{\tau}e^0 dt = \frac{kt}{\tau} \nonumber \\
g(t)&=&\frac{kt}{\tau}e^{-t/\tau}
\end{eqnarray}


\bibliography{papers}
\bibliographystyle{apalike}

\end{document}
